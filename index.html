<!DOCTYPE html>
<html lang="ko" data-theme="dark">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>체육시설 찾기 | 공공데이터 데모</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
<style>
:root{--bg:#0b0d12;--panel:#121620;--panel-2:#151a26;--text:#e9edf5;--muted:#aab3c5;--brand:#4f8cff;--accent:#22c55e;--warn:#f59e0b;--danger:#ef4444;--card:#11161f;--border:#1f2633;--shadow:0 10px 30px rgba(0,0,0,.4);--radius:16px}
[data-theme="light"]{--bg:#f7f9fc;--panel:#ffffff;--panel-2:#f2f5fb;--text:#0b1220;--muted:#5a6b85;--card:#ffffff;--border:#e7edf7;--shadow:0 10px 30px rgba(8,20,50,.08)}
*{box-sizing:border-box}html,body{height:100%}body{margin:0;background:var(--bg);color:var(--text);font:14px/1.5 Inter,system-ui,-apple-system,Segoe UI,Roboto,Pretendard,Apple SD Gothic Neo,Noto Sans KR,sans-serif}a{color:var(--brand);text-decoration:none}
header{position:sticky;top:0;z-index:20;background:linear-gradient(180deg,var(--panel),rgba(0,0,0,0));backdrop-filter:blur(6px)}
.topbar{display:flex;gap:12px;align-items:center;padding:14px 18px;border-bottom:1px solid var(--border);background:var(--panel)}
.logo{display:flex;align-items:center;gap:10px;font-weight:700;font-size:18px}
.logo .em{font-size:20px}
.searchbar{flex:1;display:flex;gap:8px}
.input,select{background:var(--panel-2);color:var(--text);border:1px solid var(--border);padding:10px 12px;border-radius:12px;outline:none}
.input:focus,select:focus{border-color:var(--brand)}
.btn{background:var(--brand);color:#fff;border:none;padding:10px 14px;border-radius:12px;cursor:pointer;box-shadow:var(--shadow);font-weight:600}
.btn.ghost{background:var(--panel-2);color:var(--text);box-shadow:none}
.btn.icon{display:inline-flex;align-items:center;gap:8px}
.btn.small{padding:8px 10px;font-size:12px}
.layout{display:grid;grid-template-columns:380px 1fr;gap:16px;padding:16px;max-width:1400px;margin:0 auto}
@media (max-width:1024px){.layout{grid-template-columns:1fr;padding:10px}}
.panel{background:var(--panel);border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow)}
.sidebar{display:flex;flex-direction:column;gap:12px;height:calc(100vh - 100px)}
.filters{padding:14px}
.filter-row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.filter-row+.filter-row{margin-top:10px}
.filter-actions{display:flex;gap:8px;align-items:center;margin-top:10px}
.result-head{display:flex;justify-content:space-between;align-items:center;padding:10px 14px;border-top:1px solid var(--border);border-bottom:1px solid var(--border);background:var(--panel-2)}
.results{overflow:auto;padding:10px;flex:1}
.card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:12px;box-shadow:var(--shadow);display:grid;gap:10px;cursor:pointer}
.card+.card{margin-top:10px}
.title-row{display:flex;justify-content:space-between;align-items:center}
.badges{display:flex;flex-wrap:wrap;gap:6px}
.badge{display:inline-flex;align-items:center;gap:6px;padding:4px 8px;border-radius:999px;font-size:12px;border:1px solid var(--border);background:var(--panel-2)}
.badge.status-운영{background:rgba(34,197,94,.15);border-color:rgba(34,197,94,.35);color:#6ee7b7}
.badge.status-휴업{background:rgba(245,158,11,.15);border-color:rgba(245,158,11,.35);color:#fbbf24}
.badge.status-폐업{background:rgba(239,68,68,.15);border-color:rgba(239,68,68,.35);color:#fca5a5}
.badge.quake{background:rgba(99,102,241,.15);border-color:rgba(99,102,241,.35);color:#a5b4fc}
.badge.selfcheck{background:rgba(59,130,246,.15);border-color:rgba(59,130,246,.35);color:#93c5fd}
.meta{color:var(--muted);font-size:12px}
.actions{display:flex;gap:8px;flex-wrap:wrap}
.content{display:grid;grid-template-rows:auto 1fr;gap:12px;height:calc(100vh - 100px)}
#map{height:100%;width:100%;border-radius:var(--radius);overflow:hidden;border:1px solid var(--border)}
dialog.modal{border:none;border-radius:20px;padding:0;max-width:820px;width:calc(100% - 24px);background:var(--panel);color:var(--text);box-shadow:var(--shadow)}
.modal header{padding:16px 18px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center}
.modal .body{padding:16px 18px;display:grid;gap:14px}
.grid-2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
@media (max-width:640px){.grid-2{grid-template-columns:1fr}}
.kv{display:grid;grid-template-columns:140px 1fr;gap:8px;align-items:start;padding:8px 10px;border:1px dashed var(--border);border-radius:10px}
.kv .k{color:var(--muted)}.kv .v{color:var(--text)}
.footer-note{padding:8px 14px;color:var(--muted);font-size:12px}
@media (max-width:1100px){.layout{grid-template-columns:1fr}.sidebar .results{max-height:42vh;min-height:34vh}#map{height:52vh}.btn{padding:12px 14px}.card .actions .mini{padding:9px 11px}.card h3{font-size:16px;line-height:1.3}}
.card:active{background:rgba(255,255,255,.04)}
</style>
</head>
<body>
<header>
<div class="topbar">
<div class="logo"><span class="em">🏟️</span><span>체육시설 찾기 (데모)</span></div>
<div class="searchbar">
<input id="q" class="input" placeholder="시설명·주소 검색" aria-label="검색"/>
<button id="nearbyBtn" class="btn icon" title="내 주변에서 찾기" aria-label="내 주변에서 찾기">📍 내 주변</button>
<select id="sort" title="정렬">
<option value="distance">거리순</option>
<option value="capacity_desc">수용인원 내림차순</option>
<option value="area_desc">면적 내림차순</option>
<option value="name_asc">이름 오름차순</option>
</select>
</div>
<div style="display:flex;gap:8px;align-items:center">
<button id="themeToggle" class="btn ghost small" aria-label="테마 전환">다크/라이트</button>
<button id="resetAll" class="btn ghost small">필터 초기화</button>
</div>
</div>
</header>
<main class="layout">
<aside class="sidebar panel" aria-label="필터와 결과">
<div class="filters">
<div class="filter-row">
<select id="sido"><option value="">시·도 (전체)</option></select>
<select id="sigungu"><option value="">시·군·구 (전체)</option></select>
</div>
<div class="filter-row">
<select id="type"><option value="">시설유형 (전체)</option></select>
<select id="indoor"><option value="">실내외 (전체)</option><option>실내</option><option>실외</option></select>
</div>
<div class="filter-row">
<select id="status"><option value="">운영상태 (전체)</option><option>운영</option><option>휴업</option><option>폐업</option></select>
<select id="openYn"><option value="">생활개방 (전체)</option><option value="true">예</option><option value="false">아니오</option></select>
</div>
<div class="filter-row">
<label><input type="checkbox" id="quake"/> 내진설계</label>
<label><input type="checkbox" id="selfcheck"/> 자율점검대상</label>
</div>
<div class="filter-row">
<input id="minCapacity" class="input" type="number" min="0" placeholder="최소 수용인원"/>
<input id="maxDistance" class="input" type="number" min="0" step="0.1" placeholder="최대 거리(km)"/>
</div>
<div class="filter-actions">
<button id="apply" class="btn">필터 적용</button>
<button id="loadDemo" class="btn ghost">데모 데이터 로드</button>
</div>
</div>
<div class="result-head">
<div>검색 결과: <strong id="resultCount">0</strong>개</div>
<div id="lastUpdated" class="meta"></div>
</div>
<div id="results" class="results" role="list" aria-label="시설 목록"></div>
<div class="footer-note">자료는 데모용이며, 실제 공공 데이터셋과 스키마 매핑 후 쉽게 대체할 수 있습니다.</div>
</aside>
<section class="content">
<div id="map" class="panel" aria-label="지도"></div>
</section>
</main>
<dialog id="detail" class="modal">
<header>
<div style="display:flex;align-items:center;gap:10px">
<div id="detailTitle" style="font-weight:800"></div>
<div id="detailBadges" class="badges"></div>
</div>
<button id="closeDetail" class="btn ghost small">닫기</button>
</header>
<div class="body">
<div class="grid-2">
<div class="kv"><div class="k">시설유형</div><div class="v" id="d_type"></div></div>
<div class="kv"><div class="k">실내/실외</div><div class="v" id="d_indoor"></div></div>
<div class="kv"><div class="k">주소</div><div class="v" id="d_addr"></div></div>
<div class="kv"><div class="k">연락처</div><div class="v" id="d_phone"></div></div>
<div class="kv"><div class="k">홈페이지</div><div class="v" id="d_home"></div></div>
<div class="kv"><div class="k">좌석/수용/면적</div><div class="v" id="d_stats"></div></div>
<div class="kv"><div class="k">관리/소유</div><div class="v" id="d_owner"></div></div>
<div class="kv"><div class="k">안전</div><div class="v" id="d_safety"></div></div>
<div class="kv"><div class="k">메타</div><div class="v" id="d_meta"></div></div>
</div>
<div class="actions" id="detailActions"></div>
</div>
</dialog>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
<script>
const demoData=[
{"id":"FAC001","name":"종로체육관","type_name":"실내체육관","category_name":"생활체육","status":"운영","indoor":"실내","open_to_public":true,"seats":1200,"capacity":1800,"area":4500,"phone":"02-321-0001","homepage_url":"https://example.or.kr/jongno","addr_road1":"서울특별시 종로구 세종대로 110","addr_road2":"(세종로)","postcode":"03045","lat":37.5720,"lng":126.9794,"sido_name":"서울특별시","sigungu_name":"종로구","mgmt_sido_name":"서울특별시","mgmt_sigungu_name":"종로구","manager_name":"홍길동","manager_phone":"02-321-9000","owner_type_name":"지자체","owner_sido_name":"서울특별시","owner_sigungu_name":"종로구","quake":true,"selfcheck":true,"created_base_date":"2024-12-31","reg_date":"2018-03-01","completed_date":"2014-08-01","closed_temp_date":null,"closed_perm_date":null,"data_source_code":"KD","deleted_flag":false,"created_at":"2025-01-02 10:00","updated_at":"2025-07-12 15:30"},
{"id":"FAC002","name":"강남스포츠센터","type_name":"수영장","category_name":"생활체육","status":"운영","indoor":"실내","open_to_public":true,"seats":300,"capacity":600,"area":2000,"phone":"02-555-1000","homepage_url":"https://example.or.kr/gangnam","addr_road1":"서울특별시 강남구 테헤란로 201","addr_road2":"(역삼동)","postcode":"06141","lat":37.4979,"lng":127.0276,"sido_name":"서울특별시","sigungu_name":"강남구","mgmt_sido_name":"서울특별시","mgmt_sigungu_name":"강남구","manager_name":"박민수","manager_phone":"02-555-2000","owner_type_name":"지자체","owner_sido_name":"서울특별시","owner_sigungu_name":"강남구","quake":true,"selfcheck":false,"created_base_date":"2024-12-31","reg_date":"2017-06-01","completed_date":"2015-10-20","data_source_code":"KD","deleted_flag":false,"created_at":"2025-02-12 11:15","updated_at":"2025-04-03 09:20"},
{"id":"FAC003","name":"해운대체육관","type_name":"실내체육관","category_name":"경기장","status":"휴업","indoor":"실내","open_to_public":false,"seats":2500,"capacity":3500,"area":8000,"phone":"051-111-2222","homepage_url":"https://example.or.kr/haeundae","addr_road1":"부산광역시 해운대구 좌동로 123","addr_road2":"","postcode":"48095","lat":35.1631,"lng":129.1635,"sido_name":"부산광역시","sigungu_name":"해운대구","mgmt_sido_name":"부산광역시","mgmt_sigungu_name":"해운대구","manager_name":"최수연","manager_phone":"051-111-1000","owner_type_name":"지자체","owner_sido_name":"부산광역시","owner_sigungu_name":"해운대구","quake":false,"selfcheck":true,"created_base_date":"2024-12-31","reg_date":"2015-03-01","completed_date":"2010-05-12","closed_temp_date":"2025-05-01","data_source_code":"KD","deleted_flag":false,"created_at":"2025-03-01 10:00","updated_at":"2025-06-01 10:10"},
{"id":"FAC004","name":"송도스포츠파크","type_name":"축구장","category_name":"야외","status":"운영","indoor":"실외","open_to_public":true,"seats":800,"capacity":1200,"area":9000,"phone":"032-000-7777","homepage_url":"https://example.or.kr/songdo","addr_road1":"인천광역시 연수구 컨벤시아대로 50","addr_road2":"","postcode":"22004","lat":37.3875,"lng":126.6422,"sido_name":"인천광역시","sigungu_name":"연수구","mgmt_sido_name":"인천광역시","mgmt_sigungu_name":"연수구","manager_name":"이서연","manager_phone":"032-000-1234","owner_type_name":"지자체","owner_sido_name":"인천광역시","owner_sigungu_name":"연수구","quake":true,"selfcheck":false,"created_base_date":"2024-12-31","reg_date":"2019-01-05","completed_date":"2016-11-11","data_source_code":"KD","deleted_flag":false,"created_at":"2025-04-01 09:00","updated_at":"2025-07-01 11:40"},
{"id":"FAC005","name":"유성국민체육센터","type_name":"실내체육관","category_name":"생활체육","status":"운영","indoor":"실내","open_to_public":true,"seats":600,"capacity":900,"area":4100,"phone":"042-888-3333","homepage_url":"https://example.or.kr/yuseong","addr_road1":"대전광역시 유성구 대학로 99","addr_road2":"","postcode":"34134","lat":36.3625,"lng":127.3568,"sido_name":"대전광역시","sigungu_name":"유성구","mgmt_sido_name":"대전광역시","mgmt_sigungu_name":"유성구","manager_name":"정해인","manager_phone":"042-888-1111","owner_type_name":"지자체","owner_sido_name":"대전광역시","owner_sigungu_name":"유성구","quake":false,"selfcheck":false,"created_base_date":"2024-12-31","reg_date":"2016-10-01","completed_date":"2014-03-03","data_source_code":"KD","deleted_flag":false,"created_at":"2025-02-20 08:30","updated_at":"2025-02-20 08:30"},
{"id":"FAC006","name":"북구종합체육관","type_name":"실내체육관","category_name":"경기장","status":"운영","indoor":"실내","open_to_public":true,"seats":1500,"capacity":2200,"area":7000,"phone":"062-555-4444","homepage_url":"https://example.or.kr/bukgu","addr_road1":"광주광역시 북구 중앙로 10","addr_road2":"","postcode":"61200","lat":35.1742,"lng":126.9120,"sido_name":"광주광역시","sigungu_name":"북구","mgmt_sido_name":"광주광역시","mgmt_sigungu_name":"북구","manager_name":"안지현","manager_phone":"062-555-1212","owner_type_name":"지자체","owner_sido_name":"광주광역시","owner_sigungu_name":"북구","quake":true,"selfcheck":true,"created_base_date":"2024-12-31","reg_date":"2013-09-13","completed_date":"2011-02-11","data_source_code":"KD","deleted_flag":false,"created_at":"2025-01-15 12:00","updated_at":"2025-06-30 09:10"},
{"id":"FAC007","name":"울산체육관","type_name":"실내체육관","category_name":"경기장","status":"운영","indoor":"실내","open_to_public":false,"seats":2000,"capacity":3000,"area":7500,"phone":"052-333-1000","homepage_url":"https://example.or.kr/ulsan","addr_road1":"울산광역시 남구 돋질로 100","addr_road2":"","postcode":"44702","lat":35.5384,"lng":129.3114,"sido_name":"울산광역시","sigungu_name":"남구","mgmt_sido_name":"울산광역시","mgmt_sigungu_name":"남구","manager_name":"김도윤","manager_phone":"052-333-2000","owner_type_name":"지자체","owner_sido_name":"울산광역시","owner_sigungu_name":"남구","quake":true,"selfcheck":false,"created_base_date":"2024-12-31","reg_date":"2012-05-01","completed_date":"2009-09-09","data_source_code":"KD","deleted_flag":false,"created_at":"2025-03-10 10:10","updated_at":"2025-04-01 13:50"},
{"id":"FAC008","name":"세종스포츠센터","type_name":"수영장","category_name":"생활체육","status":"운영","indoor":"실내","open_to_public":true,"seats":400,"capacity":700,"area":2300,"phone":"044-202-0000","homepage_url":"https://example.or.kr/sejong","addr_road1":"세종특별자치시 도움로 10","addr_road2":"","postcode":"30150","lat":36.48,"lng":127.289,"sido_name":"세종특별자치시","sigungu_name":"세종시","mgmt_sido_name":"세종특별자치시","mgmt_sigungu_name":"세종시","manager_name":"서하늘","manager_phone":"044-202-1000","owner_type_name":"지자체","owner_sido_name":"세종특별자치시","owner_sigungu_name":"세종시","quake":false,"selfcheck":true,"created_base_date":"2024-12-31","reg_date":"2020-01-15","completed_date":"2019-11-30","data_source_code":"KD","deleted_flag":false,"created_at":"2025-07-01 10:10","updated_at":"2025-07-20 09:05"},
{"id":"FAC009","name":"수원종합운동장","type_name":"축구장","category_name":"경기장","status":"운영","indoor":"실외","open_to_public":true,"seats":35000,"capacity":42000,"area":54000,"phone":"031-220-0000","homepage_url":"https://example.or.kr/suwon","addr_road1":"경기도 수원시 장안구 경수대로 893","addr_road2":"","postcode":"16306","lat":37.286,"lng":127.013,"sido_name":"경기도","sigungu_name":"수원시 장안구","mgmt_sido_name":"경기도","mgmt_sigungu_name":"수원시","manager_name":"한지민","manager_phone":"031-220-0101","owner_type_name":"지자체","owner_sido_name":"경기도","owner_sigungu_name":"수원시","quake":true,"selfcheck":true,"created_base_date":"2024-12-31","reg_date":"2001-01-01","completed_date":"2001-05-05","data_source_code":"KD","deleted_flag":false,"created_at":"2025-05-10 08:10","updated_at":"2025-06-01 08:10"},
{"id":"FAC010","name":"춘천스포츠센터","type_name":"체육관","category_name":"생활체육","status":"운영","indoor":"실내","open_to_public":true,"seats":500,"capacity":800,"area":3000,"phone":"033-250-0000","homepage_url":"https://example.or.kr/chuncheon","addr_road1":"강원특별자치도 춘천시 공지로 10","addr_road2":"","postcode":"24348","lat":37.8813,"lng":127.7298,"sido_name":"강원특별자치도","sigungu_name":"춘천시","mgmt_sido_name":"강원특별자치도","mgmt_sigungu_name":"춘천시","manager_name":"김유진","manager_phone":"033-250-0101","owner_type_name":"지자체","owner_sido_name":"강원특별자치도","owner_sigungu_name":"춘천시","quake":true,"selfcheck":false,"created_base_date":"2024-12-31","reg_date":"2019-06-06","completed_date":"2018-09-09","data_source_code":"KD","deleted_flag":false,"created_at":"2025-07-15 10:00","updated_at":"2025-07-20 10:00"},
{"id":"FAC011","name":"청주체육관","type_name":"실내체육관","category_name":"경기장","status":"운영","indoor":"실내","open_to_public":false,"seats":1500,"capacity":2200,"area":6800,"phone":"043-201-0000","homepage_url":"https://example.or.kr/cheongju","addr_road1":"충청북도 청주시 상당구 상당로 100","addr_road2":"","postcode":"28505","lat":36.6424,"lng":127.4890,"sido_name":"충청북도","sigungu_name":"청주시 상당구","mgmt_sido_name":"충청북도","mgmt_sigungu_name":"청주시","manager_name":"오지현","manager_phone":"043-201-0101","owner_type_name":"지자체","owner_sido_name":"충청북도","owner_sigungu_name":"청주시","quake":false,"selfcheck":true,"created_base_date":"2024-12-31","reg_date":"2014-02-02","completed_date":"2013-12-31","data_source_code":"KD","deleted_flag":false,"created_at":"2025-01-05 12:00","updated_at":"2025-06-05 12:00"},
{"id":"FAC012","name":"천안종합운동장","type_name":"축구장","category_name":"경기장","status":"운영","indoor":"실외","open_to_public":true,"seats":22000,"capacity":28000,"area":40000,"phone":"041-520-0000","homepage_url":"https://example.or.kr/cheonan","addr_road1":"충청남도 천안시 서북구 번영로 200","addr_road2":"","postcode":"31110","lat":36.8325,"lng":127.1241,"sido_name":"충청남도","sigungu_name":"천안시 서북구","mgmt_sido_name":"충청남도","mgmt_sigungu_name":"천안시","manager_name":"배수지","manager_phone":"041-520-0101","owner_type_name":"지자체","owner_sido_name":"충청남도","owner_sigungu_name":"천안시","quake":true,"selfcheck":false,"created_base_date":"2024-12-31","reg_date":"2008-08-08","completed_date":"2008-08-08","data_source_code":"KD","deleted_flag":false,"created_at":"2025-03-03 10:00","updated_at":"2025-06-10 10:00"},
{"id":"FAC013","name":"전주실내체육관","type_name":"실내체육관","category_name":"경기장","status":"운영","indoor":"실내","open_to_public":true,"seats":3500,"capacity":5000,"area":9000,"phone":"063-230-0000","homepage_url":"https://example.or.kr/jeonju","addr_road1":"전라북도 전주시 덕진구 기린대로 100","addr_road2":"","postcode":"54906","lat":35.8428,"lng":127.1296,"sido_name":"전라북도","sigungu_name":"전주시 덕진구","mgmt_sido_name":"전라북도","mgmt_sigungu_name":"전주시","manager_name":"정채연","manager_phone":"063-230-0101","owner_type_name":"지자체","owner_sido_name":"전라북도","owner_sigungu_name":"전주시","quake":true,"selfcheck":true,"created_base_date":"2024-12-31","reg_date":"2010-10-10","completed_date":"2010-09-09","data_source_code":"KD","deleted_flag":false,"created_at":"2025-05-05 15:00","updated_at":"2025-07-05 12:00"},
{"id":"FAC014","name":"여수종합운동장","type_name":"축구장","category_name":"경기장","status":"운영","indoor":"실외","open_to_public":true,"seats":10000,"capacity":15000,"area":30000,"phone":"061-690-0000","homepage_url":"https://example.or.kr/yeosu","addr_road1":"전라남도 여수시 좌수영로 200","addr_road2":"","postcode":"59675","lat":34.7604,"lng":127.6622,"sido_name":"전라남도","sigungu_name":"여수시","mgmt_sido_name":"전라남도","mgmt_sigungu_name":"여수시","manager_name":"장원영","manager_phone":"061-690-0101","owner_type_name":"지자체","owner_sido_name":"전라남도","owner_sigungu_name":"여수시","quake":false,"selfcheck":true,"created_base_date":"2024-12-31","reg_date":"2005-05-05","completed_date":"2004-04-04","data_source_code":"KD","deleted_flag":false,"created_at":"2025-02-02 11:00","updated_at":"2025-07-01 11:00"},
{"id":"FAC015","name":"포항실내체육관","type_name":"실내체육관","category_name":"경기장","status":"운영","indoor":"실내","open_to_public":false,"seats":2500,"capacity":3800,"area":8200,"phone":"054-270-0000","homepage_url":"https://example.or.kr/pohang","addr_road1":"경상북도 포항시 남구 희망대로 100","addr_road2":"","postcode":"37819","lat":36.0190,"lng":129.3435,"sido_name":"경상북도","sigungu_name":"포항시 남구","mgmt_sido_name":"경상북도","mgmt_sigungu_name":"포항시","manager_name":"문수빈","manager_phone":"054-270-0101","owner_type_name":"지자체","owner_sido_name":"경상북도","owner_sigungu_name":"포항시","quake":true,"selfcheck":false,"created_base_date":"2024-12-31","reg_date":"2011-11-11","completed_date":"2011-10-10","data_source_code":"KD","deleted_flag":false,"created_at":"2025-06-06 16:00","updated_at":"2025-07-01 16:00"},
{"id":"FAC016","name":"창원체육관","type_name":"실내체육관","category_name":"경기장","status":"폐업","indoor":"실내","open_to_public":false,"seats":3000,"capacity":4500,"area":8800,"phone":"055-225-0000","homepage_url":"https://example.or.kr/changwon","addr_road1":"경상남도 창원시 의창구 중앙대로 100","addr_road2":"","postcode":"51154","lat":35.227,"lng":128.681,"sido_name":"경상남도","sigungu_name":"창원시 의창구","mgmt_sido_name":"경상남도","mgmt_sigungu_name":"창원시","manager_name":"공지원","manager_phone":"055-225-0101","owner_type_name":"지자체","owner_sido_name":"경상남도","owner_sigungu_name":"창원시","quake":false,"selfcheck":false,"created_base_date":"2024-12-31","reg_date":"2000-03-03","completed_date":"1999-12-12","closed_perm_date":"2024-12-31","data_source_code":"KD","deleted_flag":false,"created_at":"2025-01-01 10:00","updated_at":"2025-02-01 09:00"},
{"id":"FAC017","name":"제주종합경기장","type_name":"축구장","category_name":"경기장","status":"운영","indoor":"실외","open_to_public":true,"seats":20000,"capacity":25000,"area":50000,"phone":"064-120-0000","homepage_url":"https://example.or.kr/jeju","addr_road1":"제주특별자치도 제주시 연삼로 123","addr_road2":"","postcode":"63100","lat":33.4996,"lng":126.5312,"sido_name":"제주특별자치도","sigungu_name":"제주시","mgmt_sido_name":"제주특별자치도","mgmt_sigungu_name":"제주시","manager_name":"이도현","manager_phone":"064-120-0101","owner_type_name":"지자체","owner_sido_name":"제주특별자치도","owner_sigungu_name":"제주시","quake":true,"selfcheck":true,"created_base_date":"2024-12-31","reg_date":"2002-02-02","completed_date":"2001-12-12","data_source_code":"KD","deleted_flag":false,"created_at":"2025-03-01 12:12","updated_at":"2025-06-20 08:00"}
];
let facilities=[];let filtered=[];let userPos=null;let map,markersLayer,userMarker,markerIndex=new Map();const el=id=>document.getElementById(id);
function init(){initTheme();initMap();loadDemo();bindUI()}
function initTheme(){const saved=localStorage.getItem("theme");if(saved==="light"||saved==="dark"){document.documentElement.setAttribute("data-theme",saved)}else{document.documentElement.setAttribute("data-theme","dark")}el("themeToggle").addEventListener("click",()=>{const cur=document.documentElement.getAttribute("data-theme")==="dark"?"light":"dark";document.documentElement.setAttribute("data-theme",cur);localStorage.setItem("theme",cur)})}
function initMap(){map=L.map("map",{zoomControl:true}).setView([36.5,127.9],6.7);L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:"&copy; OpenStreetMap"}).addTo(map);markersLayer=L.layerGroup().addTo(map)}
function bindUI(){el("apply").addEventListener("click",applyFilters);el("q").addEventListener("input",debounce(applyFilters,200));el("sort").addEventListener("change",render);el("resetAll").addEventListener("click",resetFilters);el("loadDemo").addEventListener("click",loadDemo);el("nearbyBtn").addEventListener("click",locateMe);el("closeDetail").addEventListener("click",()=>el("detail").close());el("sido").addEventListener("change",()=>{populateSigungu();applyFilters()});el("sigungu").addEventListener("change",applyFilters);el("type").addEventListener("change",applyFilters);el("indoor").addEventListener("change",applyFilters);el("status").addEventListener("change",applyFilters);el("openYn").addEventListener("change",applyFilters);el("quake").addEventListener("change",applyFilters);el("selfcheck").addEventListener("change",applyFilters);el("minCapacity").addEventListener("change",applyFilters);el("maxDistance").addEventListener("change",applyFilters);document.addEventListener("keydown",e=>{if(e.key==="Escape"&&el("detail").open)el("detail").close()})}
function loadDemo(){facilities=demoData.slice();el("lastUpdated").textContent="데이터 기준일: "+(facilities[0]?.created_base_date||"—");populateFilters();applyFilters()}
function populateFilters(){const sidos=uniq(facilities.map(f=>f.sido_name).filter(Boolean)).sort();fillSelect(el("sido"),[""].concat(sidos));const types=uniq(facilities.map(f=>f.type_name).filter(Boolean)).sort();fillSelect(el("type"),[""].concat(types));populateSigungu()}
function populateSigungu(){const sido=el("sido").value;let sigs=facilities.filter(f=>!sido||f.sido_name===sido).map(f=>f.sigungu_name).filter(Boolean);sigs=uniq(sigs).sort();fillSelect(el("sigungu"),[""].concat(sigs))}
function fillSelect(sel,items){const prev=sel.value;sel.innerHTML="";for(const item of items){const opt=document.createElement("option");opt.value=item;opt.textContent=item||sel.querySelector("option")?.textContent||"전체";sel.appendChild(opt)}if(items.includes(prev))sel.value=prev;else sel.value=""}
function applyFilters(){const q=el("q").value.trim();const sido=el("sido").value;const sigungu=el("sigungu").value;const type=el("type").value;const indoor=el("indoor").value;const status=el("status").value;const openYn=el("openYn").value;const quake=el("quake").checked;const selfcheck=el("selfcheck").checked;const minCap=parseInt(el("minCapacity").value||"0",10);const maxDist=parseFloat(el("maxDistance").value||"");filtered=facilities.filter(f=>{if(q){const hay=[f.name,f.addr_road1,f.addr_road2,f.sigungu_name,f.sido_name].join(" ").toLowerCase();if(!hay.includes(q.toLowerCase()))return false}if(sido&&f.sido_name!==sido)return false;if(sigungu&&f.sigungu_name!==sigungu)return false;if(type&&f.type_name!==type)return false;if(indoor&&f.indoor!==indoor)return false;if(status&&f.status!==status)return false;if(openYn!==""&&String(!!f.open_to_public)!==openYn)return false;if(quake&&!f.quake)return false;if(selfcheck&&!f.selfcheck)return false;if(minCap>0&&(f.capacity||0)<minCap)return false;if(!isNaN(maxDist)&&userPos){const d=distanceKm(userPos.lat,userPos.lng,f.lat,f.lng);if(d>maxDist)return false}return true});render()}
function render(){const sort=el("sort").value;const pos=userPos;filtered.sort((a,b)=>{if(sort==="name_asc")return(a.name||"").localeCompare(b.name||"","ko");if(sort==="capacity_desc")return(b.capacity||0)-(a.capacity||0);if(sort==="area_desc")return(b.area||0)-(a.area||0);if(sort==="distance"){const da=pos?distanceKm(pos.lat,pos.lng,a.lat,a.lng):Infinity;const db=pos?distanceKm(pos.lat,pos.lng,b.lat,b.lng):Infinity;return da-db}return 0});const cont=el("results");cont.innerHTML="";el("resultCount").textContent=String(filtered.length);markerIndex.clear();for(const f of filtered){const card=document.createElement("div");card.className="card";card.setAttribute("data-id",f.id);const statusBadge=`<span class="badge status-${f.status}">${f.status}</span>`;const ioBadge=`<span class="badge">${f.indoor||"—"}</span>`;const openBadge=`<span class="badge">생활개방: ${f.open_to_public?"예":"아니오"}</span>`;const quakeBadge=f.quake?'<span class="badge quake">내진</span>':"";const selfBadge=f.selfcheck?'<span class="badge selfcheck">자율점검</span>':"";const dist= userPos?`${distanceKm(userPos.lat,userPos.lng,f.lat,f.lng).toFixed(1)} km`:"—";const homeHref=normalizeUrl(f.homepage_url);const homeBtn=homeHref?`<a class="btn small ghost" target="_blank" rel="noopener" href="${homeHref}">홈페이지</a>`:"";card.innerHTML=`
<div class="title-row">
  <div style="font-weight:800">${escapeHtml(f.name)}</div>
  <div class="badges">${statusBadge}${ioBadge}${openBadge}${quakeBadge}${selfBadge}</div>
</div>
<div class="meta">${escapeHtml(f.sido_name||"")} ${escapeHtml(f.sigungu_name||"")} · ${escapeHtml(f.addr_road1||"")}<span style="margin-left:6px">| 거리: ${dist}</span></div>
<div class="actions" data-actions>
  <button class="btn small ghost" data-action="detail">상세</button>
  ${f.phone?`<a class="btn small" href="tel:${f.phone}">전화</a>`:""}
  ${homeBtn}
  <button class="btn small ghost" data-action="route">길찾기</button>
</div>`;card.addEventListener("click",e=>{if(e.target.closest("[data-actions]"))return;openDetail(f);focusMarker(f)});card.querySelector('[data-action="detail"]').addEventListener("click",e=>{e.stopPropagation();openDetail(f);focusMarker(f)});card.querySelector('[data-action="route"]').addEventListener("click",e=>{e.stopPropagation();openDirections(f)});cont.appendChild(card)}markersLayer.clearLayers();const pts=[];for(const f of filtered){if(!(f.lat&&f.lng))continue;const m=L.marker([f.lat,f.lng]).addTo(markersLayer);m.bindPopup(`<b>${escapeHtml(f.name)}</b><br/>${escapeHtml(f.type_name||"")} · ${escapeHtml(f.status)}<br/>${escapeHtml(f.addr_road1||"")}`);m.on("click",()=>openDetail(f));markerIndex.set(f.id,m);pts.push([f.lat,f.lng])}if(pts.length===1){map.setView(pts[0],Math.max(map.getZoom(),12))}else if(pts.length>1){const bounds=L.latLngBounds(pts);if(bounds.isValid())map.fitBounds(bounds.pad(0.15))}if(userPos){if(userMarker)userMarker.remove();userMarker=L.circleMarker([userPos.lat,userPos.lng],{radius:8,color:"#22c55e",fill:true,fillOpacity:0.9}).addTo(map).bindPopup("내 위치")}}
function focusMarker(f){const m=markerIndex.get(f.id);if(m){map.setView([f.lat,f.lng],Math.max(map.getZoom(),12),{animate:true});m.openPopup()}}
function openDetail(f){el("detailTitle").textContent=f.name||"";const badges=[];badges.push(`<span class="badge status-${f.status}">${f.status}</span>`);if(f.indoor)badges.push(`<span class="badge">${f.indoor}</span>`);badges.push(`<span class="badge">생활개방: ${f.open_to_public?"예":"아니오"}</span>`);if(f.quake)badges.push("<span class='badge quake'>내진</span>");if(f.selfcheck)badges.push("<span class='badge selfcheck'>자율점검</span>");el("detailBadges").innerHTML=badges.join("");el("d_type").textContent=[f.type_name||"—",f.category_name||""].filter(Boolean).join(" · ");el("d_indoor").textContent=f.indoor||"—";el("d_addr").textContent=[f.postcode?`(${f.postcode})`:"",f.addr_road1||"",f.addr_road2||""].filter(Boolean).join(" ");el("d_phone").innerHTML=f.phone?`<a href="tel:${f.phone}">${escapeHtml(f.phone)}</a>`:"—";const home=normalizeUrl(f.homepage_url);el("d_home").innerHTML=home?`<a target="_blank" rel="noopener" href="${home}">${escapeHtml(home)}</a>`:"—";el("d_stats").textContent=`관람석 ${fmt(f.seats)}석 · 수용 ${fmt(f.capacity)}명 · 면적 ${fmt(f.area)}㎡`;el("d_owner").textContent=`관리: ${f.mgmt_sido_name||""} ${f.mgmt_sigungu_name||""} (${f.manager_name||""} ${f.manager_phone||""}) / 소유: ${f.owner_type_name||""}`;el("d_safety").textContent=`내진설계 ${f.quake?"예":"아니오"} · 자율점검대상 ${f.selfcheck?"예":"아니오"}`;el("d_meta").textContent=`기준일 ${f.created_base_date||"—"} / 등록 ${f.reg_date||"—"} / 준공 ${f.completed_date||"—"} / 휴업 ${f.closed_temp_date||"—"} / 폐업 ${f.closed_perm_date||"—"} / 업데이트 ${f.updated_at||"—"}`;const act=el("detailActions");act.innerHTML="";if(f.phone){const callBtn=document.createElement("a");callBtn.className="btn";callBtn.href=`tel:${f.phone}`;callBtn.textContent="전화";act.appendChild(callBtn)}if(home){const webBtn=document.createElement("a");webBtn.className="btn ghost";webBtn.target="_blank";webBtn.rel="noopener";webBtn.href=home;webBtn.textContent="홈페이지";act.appendChild(webBtn)}const routeBtn=document.createElement("button");routeBtn.className="btn ghost";routeBtn.textContent="길찾기";routeBtn.onclick=()=>openDirections(f);act.appendChild(routeBtn);el("detail").showModal()}
function openDirections(f){if(!(f.lat&&f.lng))return alert("좌표 정보가 없습니다.");const kakao=`https://map.kakao.com/link/map/${encodeURIComponent(f.name)},${f.lat},${f.lng}`;window.open(kakao,"_blank")}
function locateMe(){if(!navigator.geolocation){alert("이 브라우저는 위치 기능을 지원하지 않습니다.");return}navigator.geolocation.getCurrentPosition(pos=>{userPos={lat:pos.coords.latitude,lng:pos.coords.longitude};applyFilters();if(userPos)map.setView([userPos.lat,userPos.lng],12)},err=>{alert("위치 권한이 거부되었거나 오류가 발생했습니다.");console.warn(err)},{enableHighAccuracy:true,timeout:8000,maximumAge:10000})}
function resetFilters(){for(const id of ["q","sido","sigungu","type","indoor","status","openYn","minCapacity","maxDistance"])el(id).value="";el("quake").checked=false;el("selfcheck").checked=false;populateSigungu();applyFilters()}
function uniq(arr){return[...new Set(arr)]}
function fmt(n){return(n||0).toLocaleString("ko-KR")}
function escapeHtml(s){return String(s||"").replace(/[&<>"']/g,c=>({"&":"&amp;","<":"&lt;",">":"&gt;",""":"&quot;","'":"&#39;"}[c]))}
function normalizeUrl(u){if(!u)return"";if(/^https?:\/\//i.test(u))return u;return"http://"+u}
function debounce(fn,ms){let t;return(...a)=>{clearTimeout(t);t=setTimeout(()=>fn.apply(this,a),ms)}}
function toRad(d){return d*Math.PI/180}
function distanceKm(lat1,lon1,lat2,lon2){const R=6371;const dLat=toRad(lat2-lat1);const dLon=toRad(lon2-lon1);const a=Math.sin(dLat/2)**2+Math.cos(toRad(lat1))*Math.cos(toRad(lat2))*Math.sin(dLon/2)**2;return R*2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}
window.addEventListener("DOMContentLoaded",init);
</script>
</body>
</html>
